{"ast":null,"code":"var _jsxFileName = \"/Users/home/dev/cshyper/src/App.js\";\nimport React from \"react\";\nimport Header from \"./components/Header\";\nimport Table from \"./components/Table\";\nimport Form from \"./components/Form\";\nimport firebase from \"./firebase\";\nimport \"./App.css\";\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isHome: true,\n      numOfRankers: 0,\n      isAdmin: false,\n      rankedTeams: [],\n      rankings: [],\n      unrankedTeams: []\n    };\n    this.calcRankings = this.calcRankings.bind(this);\n    this.toggleAdmin = this.toggleAdmin.bind(this);\n    this.switchTab = this.switchTab.bind(this);\n    this.componentDidMount = this.componentDidMount.bind(this);\n  }\n\n  componentDidMount() {\n    let db = firebase.firestore();\n    db.collection(\"rankings\").get().then(querySnapshot => {\n      querySnapshot.forEach(doc => {\n        this.setState(curr => {\n          let pushed = curr.rankings.concat(doc.data());\n          return {\n            rankings: pushed\n          };\n        });\n      });\n    }).then(this.calcRankings);\n    db.collection(\"teams\").get().then(querySnapshot => {\n      querySnapshot.forEach(doc => {\n        console.log(doc.data()); // {teams: []}\n\n        this.setState({\n          unrankedTeams: doc.data().teams\n        });\n      });\n    });\n  }\n\n  calcRankings() {\n    let response = this.state.rankings;\n    let rankings = [];\n    let allTeams = [];\n    this.setState({\n      numOfRankers: response.length\n    });\n\n    for (let i = 0; i < response.length; i++) {\n      let individualRanking = {\n        ranker: response[i][\"Ranker\"],\n        country: response[i][\"Country\"],\n        rankings: []\n      };\n\n      for (let j = 1; j < 21; j++) {\n        // change back to 21\n        let team = response[i][j];\n        individualRanking.rankings.push(team);\n      }\n\n      rankings.push(individualRanking);\n    }\n\n    for (let i = 0; i < rankings.length; i++) {\n      for (let j = 0; j < rankings[i].rankings.length; j++) {\n        let team = rankings[i].rankings[j].toLowerCase().trim();\n        let pointsToAdd = 20 - j;\n        let index = allTeams.findIndex(obj => obj.name === team);\n\n        if (index === -1) {\n          allTeams.push({\n            name: team,\n            points: pointsToAdd,\n            best: j + 1,\n            worst: j + 1,\n            appearances: 1\n          });\n        } else {\n          allTeams[index].points += pointsToAdd;\n          allTeams[index].appearances += 1;\n\n          if (j < allTeams[index].best) {\n            allTeams[index].best = j + 1;\n          } else if (j > allTeams[index].worst) {\n            allTeams[index].worst = j + 1;\n          }\n        }\n      }\n    }\n\n    allTeams = allTeams.sort((a, b) => a.points < b.points ? 1 : -1);\n    this.setState({\n      rankedTeams: allTeams\n    });\n    console.log(this.state.rankedTeams);\n    return allTeams;\n  }\n\n  toggleAdmin() {\n    this.state.isAdmin ? this.setState({\n      isAdmin: false\n    }) : this.setState({\n      isAdmin: true\n    });\n  }\n\n  switchTab() {\n    this.state.isHome ? this.setState({\n      isHome: false\n    }) : this.setState({\n      isHome: true\n    });\n  }\n\n  render() {\n    if (this.state.isHome) {\n      // showRankingsPage\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114\n        },\n        __self: this\n      }, React.createElement(Header, {\n        isHome: this.state.isHome,\n        switch: this.switchTab,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115\n        },\n        __self: this\n      }), React.createElement(Table, {\n        className: \"rankingsTable\",\n        rankedTeams: this.state.rankedTeams,\n        rankersCount: this.state.numOfRankers,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116\n        },\n        __self: this\n      }));\n    } else {\n      // setRankingsPage\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127\n        },\n        __self: this\n      }, React.createElement(Header, {\n        isHome: this.state.isHome,\n        switch: this.switchTab,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      }), React.createElement(Form, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      }));\n    }\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/home/dev/cshyper/src/App.js"],"names":["React","Header","Table","Form","firebase","App","Component","constructor","props","state","isHome","numOfRankers","isAdmin","rankedTeams","rankings","unrankedTeams","calcRankings","bind","toggleAdmin","switchTab","componentDidMount","db","firestore","collection","get","then","querySnapshot","forEach","doc","setState","curr","pushed","concat","data","console","log","teams","response","allTeams","length","i","individualRanking","ranker","country","j","team","push","toLowerCase","trim","pointsToAdd","index","findIndex","obj","name","points","best","worst","appearances","sort","a","b","render"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport Header from \"./components/Header\";\nimport Table from \"./components/Table\";\nimport Form from \"./components/Form\";\nimport firebase from \"./firebase\";\nimport \"./App.css\";\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isHome: true,\n      numOfRankers: 0,\n      isAdmin: false,\n      rankedTeams: [],\n      rankings: [],\n      unrankedTeams: []\n    };\n    this.calcRankings = this.calcRankings.bind(this);\n    this.toggleAdmin = this.toggleAdmin.bind(this);\n    this.switchTab = this.switchTab.bind(this);\n    this.componentDidMount = this.componentDidMount.bind(this);\n  }\n\n  componentDidMount() {\n    let db = firebase.firestore();\n    db.collection(\"rankings\")\n      .get()\n      .then(querySnapshot => {\n        querySnapshot.forEach(doc => {\n          this.setState(curr => {\n            let pushed = curr.rankings.concat(doc.data());\n            return {\n              rankings: pushed\n            };\n          });\n        });\n      })\n      .then(this.calcRankings);\n    db.collection(\"teams\")\n      .get()\n      .then(querySnapshot => {\n        querySnapshot.forEach(doc => {\n          console.log(doc.data()); // {teams: []}\n          this.setState({ unrankedTeams: doc.data().teams });\n        });\n      });\n  }\n\n  calcRankings() {\n    let response = this.state.rankings;\n    let rankings = [];\n    let allTeams = [];\n    this.setState({ numOfRankers: response.length });\n    for (let i = 0; i < response.length; i++) {\n      let individualRanking = {\n        ranker: response[i][\"Ranker\"],\n        country: response[i][\"Country\"],\n        rankings: []\n      };\n      for (let j = 1; j < 21; j++) {\n        // change back to 21\n        let team = response[i][j];\n        individualRanking.rankings.push(team);\n      }\n\n      rankings.push(individualRanking);\n    }\n    for (let i = 0; i < rankings.length; i++) {\n      for (let j = 0; j < rankings[i].rankings.length; j++) {\n        let team = rankings[i].rankings[j].toLowerCase().trim();\n        let pointsToAdd = 20 - j;\n        let index = allTeams.findIndex(obj => obj.name === team);\n        if (index === -1) {\n          allTeams.push({\n            name: team,\n            points: pointsToAdd,\n            best: j + 1,\n            worst: j + 1,\n            appearances: 1\n          });\n        } else {\n          allTeams[index].points += pointsToAdd;\n          allTeams[index].appearances += 1;\n          if (j < allTeams[index].best) {\n            allTeams[index].best = j + 1;\n          } else if (j > allTeams[index].worst) {\n            allTeams[index].worst = j + 1;\n          }\n        }\n      }\n    }\n    allTeams = allTeams.sort((a, b) => (a.points < b.points ? 1 : -1));\n    this.setState({\n      rankedTeams: allTeams\n    });\n    console.log(this.state.rankedTeams);\n    return allTeams;\n  }\n  toggleAdmin() {\n    this.state.isAdmin\n      ? this.setState({ isAdmin: false })\n      : this.setState({ isAdmin: true });\n  }\n  switchTab() {\n    this.state.isHome\n      ? this.setState({ isHome: false })\n      : this.setState({ isHome: true });\n  }\n  render() {\n    if (this.state.isHome) {\n      // showRankingsPage\n      return (\n        <div>\n          <Header isHome={this.state.isHome} switch={this.switchTab} />\n          <Table\n          \n            className=\"rankingsTable\"\n            rankedTeams={this.state.rankedTeams}\n            rankersCount={this.state.numOfRankers}\n          />\n        </div>\n      );\n    } else {\n      // setRankingsPage\n      return (\n        <div>\n          <Header isHome={this.state.isHome} switch={this.switchTab} />\n          <Form />\n        </div>\n      );\n    }\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}